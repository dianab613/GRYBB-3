<html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1">
<head>
  <link rel="stylesheet" href="signupform.css">
  <title> Signup Form </title>
</head>
<body>
<img src="logo.png" alt="Grybb Logo">
<div class="banner-text">
  <p style="line-height:200%; text-align: center; font-size: 150%; color: #414042;  font-family: Tahoma, sans-serif;	">
    <b> Create an account </b></p>
  <form target="useless">
    <input style="margin-top:-3%" type="text" placeholder="First Name" name="fname" required>
    <br><br>
    <input type="text" placeholder="Last Name" name="lname" required>
    <br><br>
    <input type="text" placeholder="Email (username)" name="uname" required>
    <br><br>
    <input id="myInput" type="password" placeholder="Password" name="psw" required>
    <br>
    <br>
    <button class="showpsw" type="button" onclick="showpass()">Show Password</button>

    <script>
      function showpass() {
        var x = document.getElementById("myInput");
        if (x.type == "password") {
          x.type = "text";
        } else {
          x.type = "password";
        }
      }

      function createAcc() {
        alert("1");
        let xmlhttpPost = new XMLHttpRequest();
        xmlhttpPost.onreadystatechange = function () {

          if (this.readyState === 4 && this.status === 200) {
             if (this.response === true) {
            alert("2");
            window.location.replace("/loginportal.html")
              }
          }
        }
        alert("3");
        xmlhttpPost.open("POST", "/rest/signupform/add", true);
        xmlhttpPost.setRequestHeader("Content-type", "application/json");
        alert("4");
        let uname = document.getElementsByName("uname");
        let fname = document.getElementsByName("fname");
        let lname = document.getElementsByName("lname");
        let name = fname[0].value + " " + lname[0].value;
        let psw = document.getElementsByName("psw");
       // var role;
        alert("5");
        // if (uname.values().contains("employee")) {
        //   role = "Field Engineer";
        // } else if (uname.contains("municipality")){
        //   role = "Municipality";
        // } else if(uname.contains("manager")){
        //   role = "Manager";
        //   }
          let jsonText = {
            "name" : name,
            "uname" : uname[0].value,
            "psw" : psw[0].value,
            "role" : "Field Engineer"
          }
        alert(jsonText);
          xmlhttpPost.send(JSON.stringify(jsonText));
      }
    </script>
    <br>
    <br>
    <button class="cnlbutton" onclick="document.location= 'loginportal.html'">Cancel </button>
    <button type="submit" onclick="createAcc()">Create</button>

  </form>

</div>
</body>
</html>